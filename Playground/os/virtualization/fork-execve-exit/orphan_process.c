// 当一个进程正在运行时, 他的父进程忽然退出, 此时该进程就是一个孤儿进程.
// A C program to demonstrate Orphan Process. 
// Parent process finishes execution while the
// child process is running. The child process
// becomes orphan.
#include <unistd.h>
#include <stdio.h>

int main ()
{
    /*fpid 表示 fork 函数返回的值, fork 会返回两次, 
    一次是父进程, 返回值是子进程的Pid, 在子进程会返回0*/
    pid_t fpid;
    fpid=fork(); //fork 后会出现两个分支执行下面的代码, 一个父进程, 一个新的子进程
    if (fpid < 0)
        printf("fork error!");
    else if (fpid == 0) {
        printf("child id is %d\n", getpid());
        sleep(100); //睡眠, 在父进程之前退出
        printf("child is in the end game.\n");
    }
    else { // 父进程
        printf("parent id is %d\n", getpid());
        sleep(30);
        printf("parent is in the end game.\n");
    }
}
